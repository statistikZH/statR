<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Excel-Tabellen • statR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Excel-Tabellen">
<meta property="og:description" content="statR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Excel-Tabellen.html">Excel-Tabellen</a>
    </li>
    <li>
      <a href="../articles/Sonstige_Funktionen.html">Sonstige Funktionen</a>
    </li>
    <li>
      <a href="../articles/Visualisierungen.html">Visualisierungen</a>
    </li>
    <li>
      <a href="../articles/html_report_template.html">HTML Dokumente im ZH.CH-Design</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/statistikZH/statR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Excel-Tabellen</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/statistikZH/statR/blob/HEAD/vignettes/Excel-Tabellen.Rmd" class="external-link"><code>vignettes/Excel-Tabellen.Rmd</code></a></small>
      <div class="hidden name"><code>Excel-Tabellen.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="allgemeine-informationen">Allgemeine Informationen<a class="anchor" aria-label="anchor" href="#allgemeine-informationen"></a>
</h2>
<p>Das <code>statR</code> Package enthält Funktionen zur schnellen
Erzeugung von Microsoft Excel-Dateien mithilfe des <a href="https://github.com/awalker89/openxlsx" class="external-link">openxlsx</a> Pakets. Die
Voreinstellungen orientieren sich am Corporate Design vom Statistischen
Amt Kanton Zürich, Anwender können diese Voreinstellungen aber auch an
ihre Bedürfnisse anpassen. Entweder, indem sie Anpassungen in den
Eingabeargumenten der Funktionen vornehmen, oder indem sie eine eigene
Konfiguration anlegen.</p>
<p>Diese Vignette bietet einen Überblick der wichtigsten Funktionen in
diesem Paket sowie einen Leitfaden zur Handhabung von
Nutzerkonfigurationen.</p>
</div>
<div class="section level2">
<h2 id="funktionen-und-beispiele">Funktionen und Beispiele<a class="anchor" aria-label="anchor" href="#funktionen-und-beispiele"></a>
</h2>
<div class="section level3">
<h3 id="quickxlsx">quickXLSX<a class="anchor" aria-label="anchor" href="#quickxlsx"></a>
</h3>
<p>Die Funktion <code>quickXLSX</code> bietet die einfachste
Möglichkeit, in R eine Excel-Datei mit einem Datensatz zu erzeugen. Die
Output-Datei besteht aus einem einzelnen Arbeitsblatt mit einem Header
für ein Logo, Kontaktangaben, Titel, Quelle und Metadaten.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars_title</span> <span class="op">&lt;-</span> <span class="st">"Motor trend car road tests"</span></span>
<span><span class="va">mtcars_source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Henderson and Velleman (1981). Building multiple "</span>,</span>
<span>                        <span class="st">"regression models interactively. "</span>,</span>
<span>                        <span class="st">"Biometrics, 37, 391–411."</span><span class="op">)</span></span>
<span><span class="va">mtcars_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"The data was extracted from the 1974 Motor Trend "</span>,</span>
<span>                          <span class="st">"US magazine and comprises fuel consumption and "</span>,</span>
<span>                          <span class="st">"10 aspects of automobile design and performance "</span>,</span>
<span>                          <span class="st">"for 32 automobiles (1973–74 models)."</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Wenn logo, contactdetails und homepage NA sind, werden die Werte aus der </span></span>
<span><span class="co"># Nutzerkonfiguration verwendet</span></span>
<span><span class="fu"><a href="../reference/quickXLSX.html">quickXLSX</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mtcars</span>, </span>
<span>          file <span class="op">=</span> <span class="st">"output/quickxlsx_demo"</span>,</span>
<span>          title <span class="op">=</span> <span class="va">mtcars_title</span>, </span>
<span>          source <span class="op">=</span> <span class="va">mtcars_source</span>,</span>
<span>          metadata <span class="op">=</span> <span class="va">mtcars_metadata</span>,</span>
<span>          grouplines <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>          group_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          logo <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>          contactdetails <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>          homepage <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>          author <span class="op">=</span> <span class="st">"Vorname Nachname"</span>,</span>
<span>          config <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="img/quickXLSX.PNG" style="width:95.0%" alt="Screenshot von motor_trend_car_road_tests.xlsx"><div class="figcaption">Screenshot von
motor_trend_car_road_tests.xlsx</div>
</div>
</div>
<div class="section level3">
<h3 id="axlsx">aXLSX<a class="anchor" aria-label="anchor" href="#axlsx"></a>
</h3>
<p>Mit der Funktion <code>aXLSX</code> hat zum Ziel, möglichst
<strong>barrierefreie</strong> Excel-Tabellen zu erstellen, die sich
auch für die Publikation auf <a href="zh.ch">zh.ch</a> eignen (siehe: <a href="https://statistikzh.github.io/axguide/grafiken.html#components" class="external-link uri">https://statistikzh.github.io/axguide/grafiken.html#components</a>).
Dazu werden Daten und Metadateninformationen in separate Arbeitsblätter
abgefüllt. Das erste Arbeitsblatt beinhaltet einen Titel, eine
Quellenangabe und die Daten, das zweite Arbeitsblatt Hinweise zu den
Daten sowie Kontaktinformationen.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars_title</span> <span class="op">&lt;-</span> <span class="st">"Motor trend car road tests"</span></span>
<span><span class="va">mtcars_source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Henderson and Velleman (1981). Building multiple "</span>,</span>
<span>                        <span class="st">"regression models interactively. "</span>,</span>
<span>                        <span class="st">"Biometrics, 37, 391–411."</span><span class="op">)</span></span>
<span><span class="va">mtcars_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"The data was extracted from the 1974 Motor Trend "</span>,</span>
<span>                          <span class="st">"US magazine and comprises fuel consumption and "</span>,</span>
<span>                          <span class="st">"10 aspects of automobile design and performance "</span>,</span>
<span>                          <span class="st">"for 32 automobiles (1973–74 models)."</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/aXLSX.html">aXLSX</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mtcars</span>,</span>
<span>      file <span class="op">=</span> <span class="st">"output/axlsx_demo"</span>,</span>
<span>      title <span class="op">=</span> <span class="va">mtcars_title</span>,</span>
<span>      source <span class="op">=</span> <span class="va">mtcars_source</span>,</span>
<span>      metadata <span class="op">=</span> <span class="va">mtcars_metadata</span>,</span>
<span>      author <span class="op">=</span> <span class="st">"Vorname Nachname"</span>,</span>
<span>      config <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="img/aXLSX_1.PNG" style="width:95.0%" alt="Screenshot des Datenblatts in der Datei motor_trend_car_road_tests.xlsx"><div class="figcaption">Screenshot des Datenblatts in der Datei
motor_trend_car_road_tests.xlsx</div>
</div>
<div class="float">
<img src="img/aXLSX_2.PNG" style="width:95.0%" alt="Screenshot des Metadatenblatts der Datei motor_trend_car_road_tests.xlsx"><div class="figcaption">Screenshot des Metadatenblatts der Datei
motor_trend_car_road_tests.xlsx</div>
</div>
</div>
<div class="section level3">
<h3 id="splitxlsx">splitXLSX<a class="anchor" aria-label="anchor" href="#splitxlsx"></a>
</h3>
<p>Mit der Funktion <code>splitXLSX</code> lässt sich ein beliebiger
Datensatz anhand eines Merkmals auf mehrere Arbeitsblätter verteilen.
Zur Vereinfachung der Navigation wird im ersten Arbeitsblatt ein
Inhaltsverzeichnis mit Hyperlinks angelegt.</p>
<p>Im folgenden Beispiel wird aus dem mtcars Datensatz eine Arbeitsmappe
erstellt, in der die Datenpunkte entsprechend der Anzahl von Zylindern
auf mehrere Arbeitsblätter aufgeteilt werden.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/splitXLSX.html">splitXLSX</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mtcars</span>,</span>
<span>          file <span class="op">=</span> <span class="st">"output/splitxlsx_demo"</span>,</span>
<span>          sheetvar <span class="op">=</span> <span class="st">"cyl"</span>,</span>
<span>          title <span class="op">=</span> <span class="va">mtcars_title</span>,</span>
<span>          source <span class="op">=</span> <span class="va">mtcars_source</span>,</span>
<span>          metadata <span class="op">=</span> <span class="va">mtcars_metadata</span>,</span>
<span>          author <span class="op">=</span> <span class="st">"Vorname Nachname"</span>,</span>
<span>          config <span class="op">=</span> <span class="st">"default"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Das Argument <code>sheetvar</code> sollte eine Variable mit einer
begrenzten Anzahl von Ausprägungen mit intuitiven Bedeutungen sein (zB.
Altersklassen, Jahre oder Regionen). Ferner wird implizit angenommen,
dass die Quellangaben und Metadaten für jede der Ausprägungen gelten.
Andernfalls sollte die Funktion <code>datasetsXLSX</code> verwendet
werden.</p>
</div>
<div class="section level3">
<h3 id="datasetsxlsx">datasetsXLSX<a class="anchor" aria-label="anchor" href="#datasetsxlsx"></a>
</h3>
<p>Die Funktion <code>datasetsXLSX</code> ermöglicht die Erzeugung
komplexerer Arbeitsmappen mit mehreren Datensätzen sowie die Einbindung
von Grafiken (ggplot-Objekte oder Pfadangaben zu Bild-Dateien). Die
Datensätze und Grafiken werden dabei als Liste im Funktionsargument
<code>datasets</code> übergeben. Jeder Eintrag wird in ein neues
Arbeitsblatt exportiert und kann wahlweise mit Titeln, Quellangaben und
Metadaten versehen werden. Wie in <code>splitXLSX</code> wird ein
Deckblatt mit einem Inhaltsverzeichnis erzeugt. Ferner besteht die
Möglichkeit, mit dem Argument <code>metadata_sheet</code> ein Beiblatt
zu erzeugen.</p>
<p>Das folgende Beispiel demonstriert diese Funktionsweisen:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># --- mtcars ---</span></span>
<span><span class="va">mtcars_dataset</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span>
<span></span>
<span><span class="co"># --- PlantGrowth ---</span></span>
<span><span class="va">PlantGrowth_dataset</span> <span class="op">&lt;-</span> <span class="va">PlantGrowth</span></span>
<span><span class="va">PlantGrowth_title</span> <span class="op">&lt;-</span> <span class="st">"Results from an Experiment on Plant Growth"</span></span>
<span><span class="va">PlantGrowth_source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="st">"Dobson, A. J. (1983) An Introduction to Statistical "</span>,</span>
<span>  <span class="st">"Modelling. London: Chapman and Hall."</span><span class="op">)</span></span>
<span><span class="va">PlantGrowth_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"A data frame of 30 cases on 2 variables."</span>,</span>
<span>  <span class="st">"[, 1] weight numeric"</span>,</span>
<span>  <span class="st">"[, 2] group factor"</span>,</span>
<span>  <span class="st">""</span>,</span>
<span>  <span class="st">"The levels of group are ‘ctrl’, ‘trt1’, and ‘trt2’."</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># --- grafik1 ---</span></span>
<span><span class="va">grafik1</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wt</span>, y <span class="op">=</span> <span class="va">hp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">grafik1_title</span> <span class="op">&lt;-</span> <span class="st">"mtcars: weight vs engine power (hp)"</span></span>
<span><span class="va">grafik1_source</span> <span class="op">&lt;-</span> <span class="va">mtcars_source</span></span>
<span></span>
<span><span class="co"># --- grafik2 ---</span></span>
<span><span class="va">grafik2</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wt</span>, y <span class="op">=</span> <span class="va">disp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">grafik2_title</span> <span class="op">&lt;-</span> <span class="st">"mtcars: weight vs engine displacement (cu. in.)"</span></span>
<span><span class="va">grafik2_source</span> <span class="op">&lt;-</span> <span class="va">mtcars_source</span></span>
<span></span>
<span><span class="co"># --- Beiblatt ---</span></span>
<span><span class="va">beiblatt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  title <span class="op">=</span> <span class="st">"Überschrift des Beiblatts"</span>,</span>
<span>  source <span class="op">=</span> <span class="st">"Quelle"</span>,</span>
<span>  metadata <span class="op">=</span> <span class="st">"Platzhalter für den Inhalt des Beiblatts"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># --- Export .xlsx ---</span></span>
<span><span class="fu"><a href="../reference/datasetsXLSX.html">datasetsXLSX</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">"output/datasetsXLSX_demo1.xlsx"</span>,</span>
<span>  datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mtcars_dataset</span>, <span class="va">PlantGrowth_dataset</span>, <span class="va">grafik1</span>, <span class="va">grafik2</span><span class="op">)</span>,</span>
<span>  sheetname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mtcars"</span>, <span class="st">"PlantGrowth"</span>, <span class="st">"Grafik1"</span>, <span class="st">"Grafik2"</span><span class="op">)</span>,</span>
<span>  title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mtcars_title</span>, <span class="va">PlantGrowth_title</span>, <span class="va">grafik1_title</span>, <span class="va">grafik2_title</span><span class="op">)</span>,</span>
<span>  source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mtcars_source</span>, <span class="va">PlantGrowth_source</span>, <span class="va">grafik1_source</span>, <span class="va">grafik2_source</span><span class="op">)</span>,</span>
<span>  metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mtcars_metadata</span>, <span class="va">PlantGrowth_metadata</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  grouplines <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_width <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  plot_height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  auftrag_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  author <span class="op">=</span> <span class="st">"Vorname Nachname"</span>,</span>
<span>  metadata_sheet <span class="op">=</span> <span class="va">beiblatt</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  config <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span></span></code></pre></div>
<p>Das Beispiel weist aus Illustrationsgründen zwei Besonderheiten
auf.</p>
<ul>
<li>Im Argument <code>metadata</code> sind zwei Einträge NULL, was einer
Leerlassung entspricht.</li>
<li>Im Argument <code>plot_width</code> wird nur ein Wert angegeben, im
Argument <code>plot_height</code> hingegen Werte für beide Grafiken.
Wird nur ein Wert angegeben, so wird dieser für alle Grafiken
verwendet.</li>
</ul>
<p>Wie der Beispielcode suggeriert, kann ein komplexer
<code>datasetsXLSX</code>-Aufruf unübersichtlich werden und Änderungen
in der Reihenfolge der Datensätze erfordern zugleich Anpassungen bei
allen übrigen Eingaben.</p>
<p>Die Funktionen der <code>add_attribute</code>-Familie bieten eine
alternativen Weg, <code>datasetsXLSX</code> zu parametrisieren. Jedes
Eingabeobjekt (sowohl Daten als auch Grafiken) kann mit Titel,
Quellangabe, Metadaten und mehr ausgestattet werden. Das so augmentierte
Objekt kann direkt in <code>datasetsXLSX</code> verwendet werden. Die
Argumente <code>title</code>, <code>source</code>, <code>metadata</code>
etc. können bei NULL belassen werden:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># --- mtcars ---</span></span>
<span><span class="va">mtcars_dataset</span> <span class="op">&lt;-</span> <span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_attribute.html">add_sheetname</a></span><span class="op">(</span><span class="st">"mtcars"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_attribute.html">add_title</a></span><span class="op">(</span><span class="va">mtcars_title</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_attribute.html">add_source</a></span><span class="op">(</span><span class="va">mtcars_source</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_attribute.html">add_metadata</a></span><span class="op">(</span><span class="va">mtcars_metadata</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PlantGrowth_dataset</span> <span class="op">&lt;-</span> <span class="va">PlantGrowth</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_attribute.html">add_sheetname</a></span><span class="op">(</span><span class="st">"PlantGrowth"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_attribute.html">add_title</a></span><span class="op">(</span><span class="va">PlantGrowth_title</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_attribute.html">add_source</a></span><span class="op">(</span><span class="va">PlantGrowth_source</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_attribute.html">add_metadata</a></span><span class="op">(</span><span class="va">PlantGrowth_metadata</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># --- grafik1 ---</span></span>
<span><span class="va">grafik1</span> <span class="op">&lt;-</span> <span class="va">grafik1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_attribute.html">add_sheetname</a></span><span class="op">(</span><span class="st">"Grafik1"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_attribute.html">add_title</a></span><span class="op">(</span><span class="st">"mtcars: weight vs engine power (hp)"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_attribute.html">add_source</a></span><span class="op">(</span><span class="va">mtcars_source</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_attribute.html">add_plot_size</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># --- grafik2 ---</span></span>
<span><span class="va">grafik2</span> <span class="op">&lt;-</span> <span class="va">grafik2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_attribute.html">add_sheetname</a></span><span class="op">(</span><span class="st">"Grafik2"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_attribute.html">add_title</a></span><span class="op">(</span><span class="st">"mtcars: weight vs engine displacement (cu. in.)"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_attribute.html">add_source</a></span><span class="op">(</span><span class="va">mtcars_source</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># --- Export .xlsx ---</span></span>
<span><span class="fu"><a href="../reference/datasetsXLSX.html">datasetsXLSX</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">"output/datasetsXLSX_demo2.xlsx"</span>,</span>
<span>  datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mtcars_dataset</span>, <span class="va">PlantGrowth_dataset</span>, <span class="va">grafik1</span>, <span class="va">grafik2</span><span class="op">)</span>,</span>
<span>  author <span class="op">=</span> <span class="st">"Vorname Nachname"</span>,</span>
<span>  metadata_sheet <span class="op">=</span> <span class="va">beiblatt</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  config <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="img/datasetsXLSX_1.PNG" style="width:95.0%" alt="Screenshot: Titelblatt der Datei datasetsXLSX_demo.xlsx"><div class="figcaption">Screenshot: Titelblatt der Datei
datasetsXLSX_demo.xlsx</div>
</div>
<div class="float">
<img src="img/datasetsXLSX_2.PNG" style="width:95.0%" alt="Screenshot: Tabelle in 2. Arbeitsblatt der Datei datasetsXLSX_demo.xlsx"><div class="figcaption">Screenshot: Tabelle in 2. Arbeitsblatt der Datei
datasetsXLSX_demo.xlsx</div>
</div>
<div class="float">
<img src="img/datasetsXLSX_3.PNG" style="width:95.0%" alt="Screenshot: Grafik in 5. Arbeitsblatt der Datei datasetsXLSX_demo.xlsx"><div class="figcaption">Screenshot: Grafik in 5. Arbeitsblatt der Datei
datasetsXLSX_demo.xlsx</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="ausgewählte-themen">Ausgewählte Themen<a class="anchor" aria-label="anchor" href="#ausgew%C3%A4hlte-themen"></a>
</h2>
<div class="section level3">
<h3 id="benutzerkonfigurationen">Benutzerkonfigurationen<a class="anchor" aria-label="anchor" href="#benutzerkonfigurationen"></a>
</h3>
<p>Um das Paket einem breiteren Anwenderkreis zugänglich zu machen,
wurden diverse Textelemente im Design parametrisiert. Eingaben, die
nicht NA sind, werden priorisiert. Werden Argumente zu Textelementen wie
Kontaktinformationen aber bei NA belassen, werden Werte aus einer
bestehenden und anpassbaren Nutzerkonfiguration substituiert. Das Paket
kommt mit einer Standardkonfiguration (“default”) mit dem folgendem
Inhalt:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Configuration file for statR</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">statR_config_name</span><span class="kw">:</span><span class="at"> default</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co"># Contact information</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">contactdetails</span><span class="kw">:</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="at">  </span><span class="fu">statR_organization</span><span class="kw">:</span><span class="at"> Statistisches Amt des Kantons Zürich</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="at">  </span><span class="fu">statR_name</span><span class="kw">:</span><span class="at"> Datashop</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="at">  </span><span class="fu">statR_phone</span><span class="kw">:</span><span class="at"> +41 43 259 75 00</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="at">  </span><span class="fu">statR_email</span><span class="kw">:</span><span class="at"> datashop@statistik.zh.ch</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="at">  </span><span class="fu">statR_homepage</span><span class="kw">:</span><span class="at"> http://www.statistik.zh.ch</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="at">  </span><span class="fu">statR_openinghours</span><span class="kw">:</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Bürozeiten</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> Montag bis Freitag</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> 09:00 bis 12:00</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> 13:00 bis 16:00</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co"># Logo: this can be one of the values statzh or zh, or a path to an image</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="fu">logo</span><span class="kw">:</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="at">  </span><span class="fu">statR_logo</span><span class="kw">:</span><span class="at"> statzh</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="at">  </span><span class="fu">statR_logo_width</span><span class="kw">:</span><span class="at"> </span><span class="fl">2.145</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="at">  </span><span class="fu">statR_logo_height</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.7865</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co"># Prefixes for strings</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="fu">prefixes</span><span class="kw">:</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="at">  </span><span class="fu">statR_prefix_date</span><span class="kw">:</span><span class="at"> </span><span class="st">"Aktualisiert am:"</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="at">  </span><span class="fu">statR_prefix_author</span><span class="kw">:</span><span class="at"> </span><span class="st">"durch:"</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="at">  </span><span class="fu">statR_prefix_phone</span><span class="kw">:</span><span class="at"> </span><span class="st">"Tel."</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="at">  </span><span class="fu">statR_prefix_order_id</span><span class="kw">:</span><span class="at"> </span><span class="st">"Auftragsnr.:"</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="co"># Default values</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a><span class="fu">defaults</span><span class="kw">:</span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="at">  </span><span class="fu">statR_index_title</span><span class="kw">:</span><span class="at"> Inhalt</span></span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a><span class="at">  </span><span class="fu">statR_index_source</span><span class="kw">:</span><span class="at"> Statistisches Amt des Kantons Zürich</span></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a><span class="at">  </span><span class="fu">statR_default_plot_width</span><span class="kw">:</span><span class="at"> </span><span class="dv">6</span></span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a><span class="at">  </span><span class="fu">statR_default_plot_height</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a></span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a><span class="co"># Miscellaneous</span></span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a><span class="fu">statR_date_format</span><span class="kw">:</span><span class="at"> </span><span class="st">"%d.%m.%Y"</span></span></code></pre></div>
<p>Basierend auf dieser Vorlage können auch weitere Konfigurationen
erstellt werden. Anwendungsbeispiele:</p>
<ul>
<li>Übersetzung von Textelementen in andere Sprachen</li>
<li>Abteilungs-/Organisationsspezifische Kontaktinformationen</li>
</ul>
<p>Bei der ersten Verwendung von statR wird mit der Funktion
<code>initUserConfigStore</code> ein Verzeichnis “~/.config/R/statR”
angelegt und eine Index-Datei erstellt. In dieser Datei werden der
Konfigurationsname und der Pfad zur Konfigurationsdatei gespeichert.</p>
<p>Neue Konfigurationen müssen zunächst mit der Funktion
<code>addUserConfig</code> registriert werden. Das folgende Beispiel
demonstriert die Vorgehensweise:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Laden der Konfiguration als Listenobjekt</span></span>
<span><span class="va">new_config</span> <span class="op">&lt;-</span> <span class="fu">statR</span><span class="fu">::</span><span class="fu"><a href="../reference/readUserConfig.html">readUserConfig</a></span><span class="op">(</span><span class="st">"default"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Anpassung einzelner Eintraege</span></span>
<span><span class="va">new_config</span><span class="op">$</span><span class="va">statR_config_name</span> <span class="op">&lt;-</span> <span class="st">"team_data"</span></span>
<span><span class="va">new_config</span><span class="op">$</span><span class="va">contactdetails</span><span class="op">$</span><span class="va">statR_name</span> <span class="op">&lt;-</span> <span class="st">"Team Data"</span></span>
<span><span class="va">new_config</span><span class="op">$</span><span class="va">logo</span><span class="op">$</span><span class="va">statR_logo</span> <span class="op">&lt;-</span> <span class="st">"zh"</span></span>
<span></span>
<span><span class="co"># Speichern &amp; Registrierung der neuen Konfiguration</span></span>
<span><span class="fu">yaml</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/yaml/man/write_yaml.html" class="external-link">write_yaml</a></span><span class="op">(</span><span class="va">new_config</span>, <span class="st">"config/team_data.yaml"</span><span class="op">)</span></span>
<span><span class="fu">statR</span><span class="fu">::</span><span class="fu"><a href="../reference/addUserConfig.html">addUserConfig</a></span><span class="op">(</span><span class="st">"team_data"</span>, <span class="st">"config/team_data.yaml"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Anwendung</span></span>
<span><span class="va">mtcars_title</span> <span class="op">&lt;-</span> <span class="st">"Motor trend car road tests"</span></span>
<span></span>
<span><span class="fu">statR</span><span class="fu">::</span><span class="fu"><a href="../reference/quickXLSX.html">quickXLSX</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mtcars</span>, </span>
<span>          file <span class="op">=</span> <span class="st">"output/userconfig_demo"</span>,</span>
<span>          title <span class="op">=</span> <span class="va">mtcars_title</span>,</span>
<span>          source <span class="op">=</span> <span class="va">mtcars_source</span>,</span>
<span>          metadata <span class="op">=</span> <span class="va">mtcars_metadata</span>,</span>
<span>          config <span class="op">=</span> <span class="st">"team_data"</span>,</span>
<span>          author <span class="op">=</span> <span class="st">"Vorname Nachname"</span><span class="op">)</span></span></code></pre></div>
<p>Schliesslich besteht noch die Möglichkeit, Konfigurationen zu
modifizieren (<code>updateUserConfig</code>) oder zu löschen
(<code>removeUserConfig</code>).</p>
</div>
<div class="section level3">
<h3 id="einbindung-von-bild-dateien">Einbindung von Bild-Dateien<a class="anchor" aria-label="anchor" href="#einbindung-von-bild-dateien"></a>
</h3>
<p>Bilder können gegenwärtig nur mit der
<code>datasetsXLSX</code>-Funktion eingebunden werden. Die Bildgrösse
muss vom Anwender über die Argumente <code>plot_width</code> und
<code>plot_height</code> definiert werden. Die folgenden Modalitäten
sind zu beachten: </p>
<p>Bei ggplot-Objekten kann es sinnvoll sein, eine universale Bildgrösse
zu definieren. Da ggplot-Objekte mit der angegebenen Bildgrösse in
Bild-Dateien konvertiert werden, wird das Seitenverhältnis in jedem Fall
eingehalten und eine unverzerrte Darstellung gewährleistet. Sofern aber
auch Bild-Dateien eingebunden werden, sollten die Angaben zu
<code>plot_height</code> und <code>plot_width</code> entsprechend dem
ursprünglichen Seitenverhältnis definiert werden, da die Bilder
andernfalls verzerrt dargestellt würden.</p>
</div>
<div class="section level3">
<h3 id="visuelle-gruppierung-von-spalten">Visuelle Gruppierung von Spalten<a class="anchor" aria-label="anchor" href="#visuelle-gruppierung-von-spalten"></a>
</h3>
<p>Mit dem Argument <code>grouplines</code> können in Datensätzen
vertikale Linien eingefügt werden, um bestimmte Spalten visuell zu
gruppieren. Dazu müssen im Argument entweder der Spaltennamen oder
Spalten-Nr. der Spalten angegeben werden, bei denen eine neue Gruppe
anfängt. Ferner können für diese Gruppen noch zusätzliche Überschriften
erstellt werden. Dazu müssen im Argument <code>group_names</code> die
Überschriftentitel angegeben werden.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/quickXLSX.html">quickXLSX</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mtcars</span>, </span>
<span>          file <span class="op">=</span> <span class="st">"output/quickXLSX_grouped.xlsx"</span>,</span>
<span>          title <span class="op">=</span> <span class="va">mtcars_title</span>, </span>
<span>          source <span class="op">=</span> <span class="va">mtcars_source</span>,</span>
<span>          metadata <span class="op">=</span> <span class="va">mtcars_metadata</span>,</span>
<span>          grouplines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>          group_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gruppe 1"</span>, <span class="st">"Gruppe 2"</span>, <span class="st">"Gruppe 3"</span><span class="op">)</span>,</span>
<span>          author <span class="op">=</span> <span class="st">"Vorname Nachname"</span>,</span>
<span>          config <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="img/quickXLSX_grouped.PNG" style="width:95.0%" alt="Screenshot: Gruppierte Spalten mit Überschriften"><div class="figcaption">Screenshot: Gruppierte Spalten mit
Überschriften</div>
</div>
</div>
<div class="section level3">
<h3 id="zeilentrennung-für-lange-texteingaben">Zeilentrennung für lange Texteingaben<a class="anchor" aria-label="anchor" href="#zeilentrennung-f%C3%BCr-lange-texteingaben"></a>
</h3>
<p>Es ist ein bekanntes Problem, dass lange Texteingaben in Feldern wie
<code>metadata</code> oder <code>source</code> abgeschnitten werden.
Ursache dafür ist, dass Microsoft Excel für verbundene Zellen keine
automatische Zeilenhöhen unterstützt. <a href="https://support.microsoft.com/en-us/topic/you-cannot-use-the-autofit-feature-for-rows-or-columns-that-contain-merged-cells-in-excel-34b54dd7-9bfc-6c8f-5ee3-2715d7db4353" class="external-link">Siehe
dazu den folgenden Support Artikel</a>.</p>
<p>Als Workaround kann man entweder die Zeilenhöhen manuell anpassen
oder das Problem vermeiden, indem man den Text händisch über mehrere
Zeilen verteilt (e.g.:
<code>c("Text Zeile 1, "Text Zeile 2", "Text Zeile 3")</code>).</p>
</div>
<div class="section level3">
<h3 id="formatierung-von-spalteninhalten">Formatierung von Spalteninhalten<a class="anchor" aria-label="anchor" href="#formatierung-von-spalteninhalten"></a>
</h3>
<p>Die <code>openxlsx</code>-Library, auf der <code>statR</code>
aufbaut, ermöglicht es, Variablen entsprechend ihrer Einheit zu
formatieren. Dazu muss der Variablen im data.frame eine der
unterstützten Klassen zugeordnet werden (“percentage”, “hyperlink”,
“comma”, “scientific”, und mehr).</p>
<ul>
<li>
<code>class(df$variable) &lt;- "percentage"</code>: Formatiert
<code>variable</code> in Prozent.</li>
<li>
<code>class(df$variable) &lt;- "hyperlink"</code>: Formatiert
<code>variable</code> als Hyperlink.</li>
<li>
<code>class(df$variable) &lt;- "scientific"</code>: Formatiert
<code>variable</code> in wissenschaftlicher Notation.</li>
<li>
<code>class(df$variable) &lt;- "comma"</code>: Formatiert
<code>variable</code> mit Apostrophs zwischen Tausenderstellen (z.B.
1’000’000).</li>
</ul>
<p>Das folgende Beispiel demonstriert den Prozess anhand des Merkmals
“drat” (rear axle ratio):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars_dataset</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">mtcars_dataset</span><span class="op">$</span><span class="va">drat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"percentage"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/quickXLSX.html">quickXLSX</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mtcars_dataset</span>, </span>
<span>          file <span class="op">=</span> <span class="st">"output/quickXLSX_pct.xlsx"</span>,</span>
<span>          title <span class="op">=</span> <span class="va">mtcars_title</span>, </span>
<span>          source <span class="op">=</span> <span class="va">mtcars_source</span>,</span>
<span>          metadata <span class="op">=</span> <span class="va">mtcars_metadata</span>,</span>
<span>          grouplines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>          group_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gruppe 1"</span>, <span class="st">"Gruppe 2"</span>, <span class="st">"Gruppe 3"</span><span class="op">)</span>,</span>
<span>          author <span class="op">=</span> <span class="st">"Vorname Nachname"</span>,</span>
<span>          config <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="img/quickXLSX_pct.PNG" style="width:95.0%" alt="Screenshot: Spaltenformatierungen"><div class="figcaption">Screenshot: Spaltenformatierungen</div>
</div>
<p>Siehe dazu auch die umfangreichere <a href="https://cran.r-project.org/web/packages/openxlsx/vignettes/Formatting.html" class="external-link"><code>openxlsx</code>-Vignette</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Andrea Schnell, Michelle Donzallaz, Lara Theiler, Thomas Knecht, Alexandra Würmli, Thomas Lo Russo, Thomas Fischer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
