<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Functions for generating formatted worksheets for data — insert_worksheet • statR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Functions for generating formatted worksheets for data — insert_worksheet"><meta property="og:description" content="Inserts a data.frame into a new formatted worksheet.
  The distinction between insert_worksheet and
  insert_worksheet_nh is that the former also generates a header with
  contact information using the function insert_header.
  Some arguments have default values which are pulled from the active user
  configuration. When using the default configuration, the logo and contact
  information of the Statistical Office of Kanton Zurich will be inserted."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Excel-Tabellen.html">Excel-Tabellen</a>
    </li>
    <li>
      <a href="../articles/Sonstige_Funktionen.html">Sonstige Funktionen</a>
    </li>
    <li>
      <a href="../articles/Visualisierungen.html">Visualisierungen</a>
    </li>
    <li>
      <a href="../articles/html_report_template.html">HTML Dokumente im ZH.CH-Design</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/statistikZH/statR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Functions for generating formatted worksheets for data</h1>
    <small class="dont-index">Source: <a href="https://github.com/statistikZH/statR/blob/HEAD/R/insert_worksheet.R" class="external-link"><code>R/insert_worksheet.R</code></a></small>
    <div class="hidden name"><code>insert_worksheet.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Inserts a data.frame into a new formatted worksheet.
  The distinction between <code>insert_worksheet</code> and
  <code>insert_worksheet_nh</code> is that the former also generates a header with
  contact information using the function <code>insert_header</code>.
  Some arguments have default values which are pulled from the active user
  configuration. When using the default configuration, the logo and contact
  information of the Statistical Office of Kanton Zurich will be inserted.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">insert_worksheet</span><span class="op">(</span></span>
<span>  <span class="va">wb</span>,</span>
<span>  <span class="va">sheetname</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  source <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  grouplines <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  logo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"statR_logo"</span><span class="op">)</span>,</span>
<span>  contactdetails <span class="op">=</span> <span class="fu"><a href="inputHelperContactInfo.html">inputHelperContactInfo</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  homepage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"statR_homepage"</span><span class="op">)</span>,</span>
<span>  author <span class="op">=</span> <span class="st">"user"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">insert_worksheet_nh</span><span class="op">(</span></span>
<span>  <span class="va">wb</span>,</span>
<span>  <span class="va">sheetname</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  source <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  grouplines <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group_names <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">insert_header</span><span class="op">(</span></span>
<span>  <span class="va">wb</span>,</span>
<span>  <span class="va">sheetname</span>,</span>
<span>  logo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"statR_logo"</span><span class="op">)</span>,</span>
<span>  contactdetails <span class="op">=</span> <span class="fu"><a href="inputHelperContactInfo.html">inputHelperContactInfo</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  homepage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"statR_homepage"</span><span class="op">)</span>,</span>
<span>  auftrag_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  author <span class="op">=</span> <span class="st">"user"</span>,</span>
<span>  openinghours <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  contact_col <span class="op">=</span> <span class="fl">13</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>wb</dt>
<dd><p>workbook object to add new worksheet to.</p></dd>


<dt>sheetname</dt>
<dd><p>Names of the worksheet in output file. Note that this name
will be truncated to 31 characters, must be unique, and cannot contain
some special characters (namely the following: /, \, ?, *, :, [, ]).</p></dd>


<dt>data</dt>
<dd><p>data to be included.</p></dd>


<dt>title</dt>
<dd><p>title to be put above the data.</p></dd>


<dt>source</dt>
<dd><p>source of the data. Default can be adjusted via user profiles</p></dd>


<dt>metadata</dt>
<dd><p>metadata information to be included. Defaults to NA, meaning
no metadata are attached.</p></dd>


<dt>grouplines</dt>
<dd><p>Can be used to visually group variables. Values should
either correspond to numeric column indices or column names, denoting the
first variable in a group. Defaults to NA, meaning no lines are added.</p></dd>


<dt>group_names</dt>
<dd><p>A vector of names for groups to be displayed in a
secondary header. Should be of the same length as grouplines, and cannot
be used unless these are set. Defaults to NA, meaning no secondary header
is created.</p></dd>


<dt>logo</dt>
<dd><p>File path to the logo to be included in the index-sheet.
Defaults to the logo of the Statistical Office of Kanton Zurich. This can
either be overridden with a path to an image file, or configured in a user
profile.</p></dd>


<dt>contactdetails</dt>
<dd><p>Character vector with contact information to be displayed
on the title sheet. By default uses <code><a href="inputHelperContactInfo.html">inputHelperContactInfo()</a></code> to
construct it based on values defined in the active user configuration.</p></dd>


<dt>homepage</dt>
<dd><p>Homepage of data publisher. Default can be adjusted via user
configuration.</p></dd>


<dt>author</dt>
<dd><p>defaults to the last two letters (initials) or numbers of the
internal user name.</p></dd>


<dt>auftrag_id</dt>
<dd><p>An ID associated with the Excel file. Defaults to NULL (
no output).</p></dd>


<dt>openinghours</dt>
<dd><p>A character vector with office hours. Defaults to NULL (
no output).</p></dd>


<dt>contact_col</dt>
<dd><p>Column number at which the contact information should be
inserted.</p></dd>

</dl></div>
    <div id="note">
    <h2>Note</h2>
    <p>This function does not output an .xlsx file on its own. A separate call
  to <code><a href="https://rdrr.io/pkg/openxlsx/man/saveWorkbook.html" class="external-link">openxlsx::saveWorkbook()</a></code> is required.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Initialize Workbook</span></span></span>
<span class="r-in"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/createWorkbook.html" class="external-link">createWorkbook</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Insert mtcars dataset with STATZH design</span></span></span>
<span class="r-in"><span><span class="fu">insert_worksheet</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">wb</span>, sheetname <span class="op">=</span> <span class="st">"cars1"</span>, data <span class="op">=</span> <span class="va">mtcars</span>, title <span class="op">=</span> <span class="st">"mtcars dataset"</span>,</span></span>
<span class="r-in"><span>  source <span class="op">=</span> <span class="st">"Source: ..."</span>, metadata <span class="op">=</span> <span class="st">"Note: ..."</span>,</span></span>
<span class="r-in"><span>  grouplines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span>, group_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"First group"</span>, <span class="st">"Second group"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The same, but without header</span></span></span>
<span class="r-in"><span><span class="fu">insert_worksheet_nh</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">wb</span>, sheetname <span class="op">=</span> <span class="st">"cars2"</span>, data <span class="op">=</span> <span class="va">mtcars</span>, title <span class="op">=</span> <span class="st">"mtcars dataset (no header)"</span>,</span></span>
<span class="r-in"><span>  source <span class="op">=</span> <span class="st">"Source: ..."</span>, metadata <span class="op">=</span> <span class="st">"Note: ..."</span>,</span></span>
<span class="r-in"><span>  grouplines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span>, group_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"First group"</span>, <span class="st">"Second group"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Andrea Schnell, Michelle Donzallaz, Lara Theiler, Thomas Knecht, Alexandra Würmli, Thomas Lo Russo, Thomas Fischer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

