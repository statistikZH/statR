#' insert_index_sheet()
#'
#' Description
#'
#' @param wb A workbook object as generated by openxlsx::createWorkbook()
#' @param logo Either statzh or zh, or path to logo file
#' @param contact Either "statzh" or a character string
#' @param homepage statzh or a character string with the URL
#' @param openinghours statzh or a character string or vector with opening hours
#' @param titlesource Character vector denoting the data source
#' @param auftrag_id Order ID
#' @param maintitle Main title
#' @keywords datasetsXLSX
#' @examples
#'\donttest{
#' \dontrun{
#'}
#'}


insert_index_sheet <- function(wb, logo, contact, homepage, openinghours,
                               titlesource, auftrag_id, maintitle){
  # Create index sheet
  openxlsx::addWorksheet(wb, sheetName = "Inhalt")

  #  hide gridlines
  openxlsx::showGridLines(wb,
                          sheet = "Inhalt",
                          showGridLines = FALSE
  )

  # set col widths
  openxlsx::setColWidths(wb,
                         sheet = "Inhalt",
                         cols = 1,
                         widths = 1)

  # insert logo

  if(!is.null(logo)){
    if(logo %in% c("statzh", "zh")){
      logo <- paste0(path.package("statR"),
                     ifelse(logo == "statzh",
                            "/extdata/Stempel_STAT-01.png",
                            "/extdata/Stempel_Kanton_ZH.png"))

      openxlsx::insertImage(wb,
                            sheet = "Inhalt",
                            file = logo,
                            startRow = 2,
                            startCol = 2,
                            width = 2.5,
                            height = 0.9,
                            units = "in")

    } else if(file.exists(logo)) {
      # Insert file at given path
      openxlsx::insertImage(wb,
                            sheet = "Inhalt",
                            file = logo,
                            width = 2.145,
                            height = 0.7865,
                            units = "in")
    } else {
      # Input argument logo does not correspond to hardcoded values
      # and no image file found at path
      warning("No logo found")
    }
  } else {
    message("No logo added")
  }

  # Contact
  if(!is.null(contact)){
    if(any(grepl(contact, pattern = "statzh"))) {
      contact <- c("Datashop", "Tel.:  +41 43 259 75 00",
                   "datashop@statistik.zh.ch")

    }

    openxlsx::writeData(wb,
                        sheet = "Inhalt",
                        x = contact,
                        xy = c("O", 2))
  }


  if(!is.null(homepage)){
    if(any(grepl(homepage, pattern = "statzh"))) {
      homepage <- "http://www.statistik.zh.ch"
    }

    class(homepage) <- 'hyperlink'
    openxlsx::writeData(wb,
                        sheet = "Inhalt",
                        x = homepage,
                        xy = c("O", 5))
  }



  if(!is.null(openinghours)){
    if(any(grepl(openinghours, pattern = "statzh"))) {
      openinghours <- c("B\u00fcrozeiten",
                        "Montag bis Freitag",
                        "09:00 bis 12:00",
                        "13:00 bis 16:00")
    }

    openxlsx::writeData(wb,
                        sheet = "Inhalt",
                        x = openinghours,
                        xy = c("R", 2))
  }

  # headerline
  headerline <- openxlsx::createStyle(border = "Bottom",
                                      borderColour = "#009ee0",
                                      borderStyle = getOption("openxlsx.borderStyle", "thick"))
  openxlsx::addStyle(wb,
                     sheet = "Inhalt",
                     style = headerline,
                     rows = 6,
                     cols = 1:20,
                     gridExpand = TRUE,
                     stack = TRUE)

  #Erstellungsdatum
  openxlsx::writeData(wb,
                      sheet = "Inhalt",
                      x = paste("Erstellt am ",
                            format(Sys.Date(), format="%d.%m.%Y")),
                      xy = c("O", 8))

  # Auftragsnummer
  if (!is.null(auftrag_id)){
    openxlsx::writeData(wb,
                        sheet = "Inhalt",
                        paste("Auftragsnr.:", auftrag_id),
                        xy = c("O", 9))
  }

  # Maintitle
  openxlsx::addStyle(wb,
                     sheet = "Inhalt",
                     style = mainTitleStyle(),
                     rows = 10,
                     cols = 3,
                     gridExpand = TRUE)

  openxlsx::writeData(wb,
                      sheet = "Inhalt",
                      x = maintitle,
                      headerStyle = mainTitleStyle(),
                      xy = c("C", 10))


  # source
  if (!is.null(titlesource)){
    if(any(grepl(titlesource, pattern = "statzh"))){
      titlesource <- "Quelle: Statistisches Amt des Kantons Z\u00fcrich"
    }

    openxlsx::writeData(wb,
                        sheet = "Inhalt",
                        x = titlesource,
                        xy = c("C", 11))
  }

  # subtitle
  openxlsx::addStyle(wb,
                     sheet = "Inhalt",
                     style = subtitleStyle(),
                     rows = 14,
                     cols = 3,
                     gridExpand = TRUE)

  openxlsx::writeData(wb,
                      sheet = "Inhalt",
                      x = "Inhalt",
                      headerStyle = subtitleStyle(),
                      xy = c("C", 13))

}
